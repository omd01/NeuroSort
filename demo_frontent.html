<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroSort - Local AI File Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Phosphor Icons for that modern desktop app feel -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        body {
            background-color: #0f0f12;
            color: #e2e8f0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
            /* App-like feel */
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1b21;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        .app-drag-region {
            -webkit-app-region: drag;
        }

        .no-drag {
            -webkit-app-region: no-drag;
        }

        /* Animations */
        @keyframes pulse-subtle {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .animate-pulse-slow {
            animation: pulse-subtle 3s infinite;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>

<body>

    <div id="root"></div>

    <script type="text/babel">

        const { useState, useEffect, useRef } = React;

        // --- Mock Data for Simulation ---
        const MOCK_FILES = [
            { name: "IMG_2024_Raw_001.CR2", type: "image", size: "24MB" },
            { name: "client_brief_v2.pdf", type: "doc", size: "1.2MB" },
            { name: "nextjs_dashboard_mockup.fig", type: "design", size: "45MB" },
            { name: "invoice_Sep_2024.pdf", type: "doc", size: "0.5MB" },
            { name: "video_intro_final.mp4", type: "video", size: "120MB" },
            { name: "screenshot_error_log.png", type: "image", size: "2MB" },
            { name: "server_config_backup.json", type: "code", size: "0.1MB" },
            { name: "marketing_copy_draft.txt", type: "doc", size: "0.1MB" },
            { name: "banner_ads_social.psd", type: "design", size: "85MB" },
            { name: "meeting_notes_Q4.docx", type: "doc", size: "1.5MB" },
        ];

        const STEPS = {
            SETUP: 0,
            MODEL_LOAD: 1,
            SELECT_DRIVE: 2,
            PROCESSING: 3,
            COMPLETE: 4
        };

        // --- Main Application Component ---
        function App() {
            const [step, setStep] = useState(STEPS.SETUP);
            const [logs, setLogs] = useState([]);
            const [processedCount, setProcessedCount] = useState(0);
            const [currentAction, setCurrentAction] = useState("");

            const addLog = (msg, type = "info") => {
                setLogs(prev => [{ id: Date.now(), msg, type }, ...prev].slice(0, 50));
            };

            return (
                <div className="h-screen w-screen flex flex-col bg-[#09090b] text-slate-200 overflow-hidden selection:bg-indigo-500/30">
                    {/* Title Bar (Electron Style) */}
                    <div className="h-10 bg-[#09090b] border-b border-white/5 flex items-center justify-between px-4 app-drag-region select-none">
                        <div className="flex items-center gap-2 text-xs font-medium text-slate-400">
                            <i className="ph-fill ph-brain text-indigo-500 text-lg"></i>
                            <span className="tracking-wide">NEUROSORT AI</span>
                            <span className="bg-white/5 px-1.5 py-0.5 rounded text-[10px] text-slate-500">v1.0.2 Local</span>
                        </div>
                        <div className="flex gap-2 no-drag">
                            <div className="w-3 h-3 rounded-full bg-yellow-500/20 hover:bg-yellow-500 transition-colors cursor-pointer"></div>
                            <div className="w-3 h-3 rounded-full bg-green-500/20 hover:bg-green-500 transition-colors cursor-pointer"></div>
                            <div className="w-3 h-3 rounded-full bg-red-500/20 hover:bg-red-500 transition-colors cursor-pointer"></div>
                        </div>
                    </div>

                    {/* Main Content Area */}
                    <div className="flex-1 relative">
                        {step === STEPS.SETUP && <SetupView onNext={() => setStep(STEPS.MODEL_LOAD)} />}
                        {step === STEPS.MODEL_LOAD && <ModelLoader onComplete={() => setStep(STEPS.SELECT_DRIVE)} addLog={addLog} />}
                        {step === STEPS.SELECT_DRIVE && <DriveSelection onStart={() => setStep(STEPS.PROCESSING)} addLog={addLog} />}
                        {step === STEPS.PROCESSING && <ProcessingDashboard onComplete={() => setStep(STEPS.COMPLETE)} addLog={addLog} />}
                        {step === STEPS.COMPLETE && <CompletionSummary onReset={() => setStep(STEPS.SELECT_DRIVE)} />}
                    </div>

                    {/* Status Bar */}
                    <div className="h-8 bg-[#0f0f12] border-t border-white/5 flex items-center px-4 text-[10px] text-slate-500 justify-between">
                        <div className="flex items-center gap-3">
                            <div className="flex items-center gap-1.5">
                                <div className={`w-1.5 h-1.5 rounded-full ${step >= STEPS.PROCESSING && step !== STEPS.COMPLETE ? 'bg-green-500 animate-pulse' : 'bg-slate-600'}`}></div>
                                {step === STEPS.PROCESSING ? "AI ENGINE ACTIVE" : "AI ENGINE STANDBY"}
                            </div>
                            <span className="w-px h-3 bg-white/10"></span>
                            <span>MEM: 420MB / 16GB</span>
                        </div>
                        <div>
                            LOCAL SERVER: PORT 11434
                        </div>
                    </div>
                </div>
            );
        }

        // --- View: 1. Setup ---
        function SetupView({ onNext }) {
            return (
                <div className="h-full flex flex-col items-center justify-center p-8 text-center relative overflow-hidden">
                    {/* Background Decorations */}
                    <div className="absolute top-1/4 left-1/4 w-64 h-64 bg-indigo-600/10 rounded-full blur-[100px]"></div>
                    <div className="absolute bottom-1/4 right-1/4 w-64 h-64 bg-purple-600/10 rounded-full blur-[100px]"></div>

                    <div className="relative z-10 max-w-md">
                        <div className="w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-8 shadow-2xl shadow-indigo-500/20">
                            <i className="ph-fill ph-brain text-4xl text-white"></i>
                        </div>

                        <h1 className="text-3xl font-bold text-white mb-3 tracking-tight">Tired of Digital Chaos?</h1>
                        <p className="text-slate-400 text-sm leading-relaxed mb-8">
                            NeuroSort uses a local, lightweight LLM to analyze your files, understand their context, and organize them into a "Twin-Directory" structure.
                            <br /><br />
                            <span className="text-indigo-400 font-medium">Private. Offline. Intelligent.</span>
                        </p>

                        <button
                            onClick={onNext}
                            className="group relative px-8 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-medium transition-all w-full overflow-hidden"
                        >
                            <div className="absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:animate-[shimmer_1.5s_infinite]"></div>
                            <span className="flex items-center justify-center gap-2">
                                Initialize System <i className="ph-bold ph-arrow-right"></i>
                            </span>
                        </button>

                        <div className="mt-6 flex justify-center gap-4 text-[10px] text-slate-600 uppercase tracking-wider font-semibold">
                            <span className="flex items-center gap-1"><i className="ph-fill ph-check-circle"></i> No Cloud Upload</span>
                            <span className="flex items-center gap-1"><i className="ph-fill ph-cpu"></i> GPU Accelerated</span>
                        </div>
                    </div>
                </div>
            );
        }

        // --- View: 2. Model Loader ---
        function ModelLoader({ onComplete, addLog }) {
            const [progress, setProgress] = useState(0);
            const [status, setStatus] = useState("Initializing Runtime...");

            useEffect(() => {
                const stages = [
                    { p: 10, msg: "Checking GPU capabilities..." },
                    { p: 30, msg: "Loading Phi-3 Mini Quantized (4-bit)..." },
                    { p: 50, msg: "Allocating Tensors..." },
                    { p: 75, msg: "Warming up Inference Engine..." },
                    { p: 90, msg: "Verifying File System Access..." },
                    { p: 100, msg: "Ready." }
                ];

                let currentStage = 0;

                const interval = setInterval(() => {
                    if (currentStage >= stages.length) {
                        clearInterval(interval);
                        setTimeout(onComplete, 800);
                        return;
                    }

                    const stage = stages[currentStage];
                    setStatus(stage.msg);
                    setProgress(stage.p);
                    addLog(stage.msg, "system");
                    currentStage++;
                }, 600);

                return () => clearInterval(interval);
            }, []);

            return (
                <div className="h-full flex flex-col items-center justify-center p-8">
                    <div className="w-full max-w-md space-y-6">
                        <div className="flex justify-between items-end text-sm mb-2">
                            <span className="text-slate-300 font-mono">{status}</span>
                            <span className="text-indigo-400 font-bold">{progress}%</span>
                        </div>

                        {/* Custom Progress Bar */}
                        <div className="h-1.5 w-full bg-slate-800 rounded-full overflow-hidden">
                            <div
                                className="h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-indigo-500 w-full transition-transform duration-500 ease-out origin-left"
                                style={{ transform: `scaleX(${progress / 100})` }}
                            ></div>
                        </div>

                        {/* Tech Specs Display */}
                        <div className="grid grid-cols-2 gap-2 mt-8">
                            <div className="glass-panel p-3 rounded border border-white/5">
                                <div className="text-[10px] text-slate-500 uppercase">Model</div>
                                <div className="text-xs text-slate-200 font-mono mt-1">Phi-3-Mini-4k-Instruct</div>
                            </div>
                            <div className="glass-panel p-3 rounded border border-white/5">
                                <div className="text-[10px] text-slate-500 uppercase">Quantization</div>
                                <div className="text-xs text-slate-200 font-mono mt-1">Q4_K_M (GGUF)</div>
                            </div>
                            <div className="glass-panel p-3 rounded border border-white/5">
                                <div className="text-[10px] text-slate-500 uppercase">Backend</div>
                                <div className="text-xs text-slate-200 font-mono mt-1">Node-Llama-CPP</div>
                            </div>
                            <div className="glass-panel p-3 rounded border border-white/5">
                                <div className="text-[10px] text-slate-500 uppercase">Memory Est.</div>
                                <div className="text-xs text-emerald-400 font-mono mt-1">~1.8 GB</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // --- View: 3. Drive Selection ---
        function DriveSelection({ onStart, addLog }) {
            const [selectedPath, setSelectedPath] = useState(null);

            const handleSelect = () => {
                // Simulation of electron dialog
                setSelectedPath("C:/Users/Developer/Downloads/Chaos_Folder");
                addLog("Selected target: C:/Users/Developer/Downloads/Chaos_Folder");
            };

            return (
                <div className="h-full flex flex-col items-center justify-center p-8 animate-fade-in">
                    <h2 className="text-xl font-semibold text-white mb-8">Select Target Workspace</h2>

                    <div className="grid grid-cols-1 gap-4 w-full max-w-lg">
                        <div
                            onClick={handleSelect}
                            className={`
                            group cursor-pointer border border-dashed rounded-xl p-8 transition-all
                            ${selectedPath ? 'border-indigo-500 bg-indigo-500/5' : 'border-slate-700 hover:border-slate-500 hover:bg-slate-800/50'}
                        `}
                        >
                            <div className="flex flex-col items-center gap-4">
                                <div className={`
                                w-16 h-16 rounded-full flex items-center justify-center transition-colors
                                ${selectedPath ? 'bg-indigo-500 text-white' : 'bg-slate-800 text-slate-400 group-hover:bg-slate-700'}
                            `}>
                                    {selectedPath ? <i className="ph-fill ph-folder-open text-2xl"></i> : <i className="ph-fill ph-plus text-2xl"></i>}
                                </div>
                                <div className="text-center">
                                    <div className="text-sm font-medium text-slate-200">
                                        {selectedPath ? "Target Locked" : "Choose Directory to Scan"}
                                    </div>
                                    <div className="text-xs text-slate-500 mt-1 font-mono">
                                        {selectedPath || "Drag folder here or click to browse"}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {selectedPath && (
                            <div className="space-y-4 mt-4">
                                <div className="glass-panel p-4 rounded-lg text-left">
                                    <div className="text-xs text-slate-400 mb-2 uppercase tracking-wider font-bold">Scanning Plan</div>
                                    <ul className="text-xs space-y-2 text-slate-300">
                                        <li className="flex items-center gap-2">
                                            <i className="ph-fill ph-check text-emerald-500"></i> Creates <code>/00_Inbox</code>
                                        </li>
                                        <li className="flex items-center gap-2">
                                            <i className="ph-fill ph-check text-emerald-500"></i> Separates Code from Assets
                                        </li>
                                        <li className="flex items-center gap-2">
                                            <i className="ph-fill ph-check text-emerald-500"></i> Renames via AI Context
                                        </li>
                                    </ul>
                                </div>
                                <button
                                    onClick={onStart}
                                    className="w-full py-3 bg-white text-black font-bold rounded-lg hover:bg-slate-200 transition-colors flex items-center justify-center gap-2"
                                >
                                    <i className="ph-bold ph-play"></i> Start Arrangement
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // --- View: 4. Processing Dashboard (The "Cool" Part) ---
        function ProcessingDashboard({ onComplete, addLog }) {
            const [files, setFiles] = useState([]);
            const [stats, setStats] = useState({ processed: 0, total: MOCK_FILES.length });
            const [currentFile, setCurrentFile] = useState(null);

            useEffect(() => {
                let index = 0;

                const processFile = () => {
                    if (index >= MOCK_FILES.length) {
                        setTimeout(onComplete, 1000);
                        return;
                    }

                    const file = MOCK_FILES[index];
                    setCurrentFile(file);
                    addLog(`Analyzing: ${file.name}`, "process");

                    // Simulate AI Thinking time varies by file type
                    const delay = file.type === 'doc' ? 1200 : 600;

                    setTimeout(() => {
                        // Determine Destination
                        let dest = "General";
                        let reason = "Extension match";

                        if (file.type === 'image') { dest = "/03_Media_Raw"; reason = "Visual Asset"; }
                        if (file.type === 'design') { dest = "/04_Design_Work"; reason = "Source File"; }
                        if (file.type === 'doc') { dest = "/02_Docs_Planning"; reason = "Context: Brief/Text"; }
                        if (file.type === 'code') { dest = "/00_DEV_REPOS (Ref)"; reason = "Code Snippet"; }
                        if (file.type === 'video') { dest = "/03_Media_Raw"; reason = "Heavy Media"; }

                        setFiles(prev => [{ ...file, dest, reason, status: 'done' }, ...prev]);
                        setStats(prev => ({ ...prev, processed: prev.processed + 1 }));
                        addLog(`Moved -> ${dest} (${reason})`, "success");

                        index++;
                        processFile();
                    }, delay);
                };

                processFile();
            }, []);

            return (
                <div className="h-full flex flex-col p-6">
                    {/* Top Stats */}
                    <div className="flex gap-4 mb-6">
                        <div className="glass-panel flex-1 p-4 rounded-xl border-l-4 border-indigo-500">
                            <div className="text-[10px] text-slate-400 uppercase tracking-wider">Files Processed</div>
                            <div className="text-2xl font-bold text-white mt-1">{stats.processed} <span className="text-slate-500 text-sm">/ {stats.total}</span></div>
                        </div>
                        <div className="glass-panel flex-1 p-4 rounded-xl border-l-4 border-purple-500">
                            <div className="text-[10px] text-slate-400 uppercase tracking-wider">Efficiency Gain</div>
                            <div className="text-2xl font-bold text-white mt-1">~14m <span className="text-slate-500 text-sm">saved</span></div>
                        </div>
                    </div>

                    {/* Main Visualization Area */}
                    <div className="flex-1 flex gap-6 min-h-0">
                        {/* Left: Live Feed */}
                        <div className="flex-[2] flex flex-col gap-4 min-h-0">
                            <div className="text-xs font-bold text-slate-500 uppercase flex items-center justify-between">
                                <span>Live Activity</span>
                                {currentFile && <span className="text-indigo-400 animate-pulse">Processing...</span>}
                            </div>

                            <div className="flex-1 overflow-y-auto pr-2 space-y-2 relative">
                                {files.map((f, i) => (
                                    <div key={i} className="bg-slate-800/50 border border-white/5 p-3 rounded-lg flex items-center justify-between animate-fade-in-up">
                                        <div className="flex items-center gap-3">
                                            <div className={`
                                            w-8 h-8 rounded flex items-center justify-center text-lg
                                            ${f.type === 'image' ? 'bg-blue-500/20 text-blue-400' : ''}
                                            ${f.type === 'doc' ? 'bg-yellow-500/20 text-yellow-400' : ''}
                                            ${f.type === 'design' ? 'bg-pink-500/20 text-pink-400' : ''}
                                            ${f.type === 'code' ? 'bg-emerald-500/20 text-emerald-400' : ''}
                                            ${f.type === 'video' ? 'bg-red-500/20 text-red-400' : ''}
                                        `}>
                                                <i className={`ph-fill ${f.type === 'image' ? 'ph-image' :
                                                        f.type === 'doc' ? 'ph-file-text' :
                                                            f.type === 'design' ? 'ph-paint-brush' :
                                                                f.type === 'code' ? 'ph-code' : 'ph-video'
                                                    }`}></i>
                                            </div>
                                            <div>
                                                <div className="text-sm text-slate-200">{f.name}</div>
                                                <div className="text-[10px] text-slate-500">{f.size} â€¢ {f.reason}</div>
                                            </div>
                                        </div>
                                        <div className="text-[10px] font-mono bg-white/5 px-2 py-1 rounded text-indigo-300">
                                            {f.dest}
                                        </div>
                                    </div>
                                ))}
                                {currentFile && (
                                    <div className="bg-indigo-500/10 border border-indigo-500/30 p-3 rounded-lg flex items-center gap-3 opacity-50">
                                        <div className="w-4 h-4 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
                                        <div className="text-sm text-indigo-300">Scanning {currentFile.name}...</div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Right: AI Thought Process (Log) */}
                        <div className="flex-1 bg-[#050505] rounded-xl border border-white/10 p-4 flex flex-col font-mono text-xs min-h-0">
                            <div className="text-slate-500 mb-3 uppercase font-bold tracking-wider">LLM Context Window</div>
                            <div className="flex-1 overflow-y-auto space-y-1.5 opacity-80">
                                {files.length > 0 && (
                                    <>
                                        <div className="text-purple-400"> prompt &gt; classify_file("{files[0].name}")</div>
                                        <div className="text-slate-400"> &gt; analyzing metadata...</div>
                                        <div className="text-slate-400"> &gt; extension: .{files[0].name.split('.').pop()}</div>
                                        <div className="text-emerald-500"> &gt; match_found: {files[0].dest} (Confidence: 98%)</div>
                                        <div className="text-slate-600"> ---</div>
                                    </>
                                )}
                                <div className="text-slate-600 animate-pulse">_ waiting for input stream</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // --- View: 5. Completion ---
        function CompletionSummary({ onReset }) {
            return (
                <div className="h-full flex flex-col items-center justify-center p-8 animate-fade-in">
                    <div className="w-20 h-20 bg-emerald-500/20 rounded-full flex items-center justify-center mb-6 text-emerald-400">
                        <i className="ph-fill ph-check text-4xl"></i>
                    </div>
                    <h2 className="text-2xl font-bold text-white mb-2">Workspace Harmonized</h2>
                    <p className="text-slate-400 text-sm mb-8 text-center max-w-md">
                        Files have been successfully moved to the Twin-Directory structure. Your "Downloads" folder is now empty.
                    </p>

                    <div className="grid grid-cols-3 gap-4 w-full max-w-lg mb-8">
                        <div className="bg-slate-800/50 p-4 rounded-lg text-center">
                            <div className="text-2xl font-bold text-white">10</div>
                            <div className="text-[10px] text-slate-500 uppercase">Files Moved</div>
                        </div>
                        <div className="bg-slate-800/50 p-4 rounded-lg text-center">
                            <div className="text-2xl font-bold text-white">5</div>
                            <div className="text-[10px] text-slate-500 uppercase">Categories</div>
                        </div>
                        <div className="bg-slate-800/50 p-4 rounded-lg text-center">
                            <div className="text-2xl font-bold text-white">0s</div>
                            <div className="text-[10px] text-slate-500 uppercase">Cloud Latency</div>
                        </div>
                    </div>

                    <button
                        onClick={onReset}
                        className="px-6 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg font-medium transition-colors"
                    >
                        Process Another Folder
                    </button>
                </div>
            );
        }

        // Add some custom animations to tailwind config in head logic if needed, 
        // but simple CSS classes work for this prototype.

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>

</html>